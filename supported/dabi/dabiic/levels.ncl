;--------------------------------------------------------------------------
; compute levels
;--------------------------------------------------------------------------

       load "./constants.ncl"

; -----------note model top cannot be zero.  Set to a small value

; -----------20 sigma levels.  Evenly spaced in level interfaces
       if(nlev .eq. 20) then 
        hyai=(/1e-5, 0.0, 0.0, 0.0, \
              0.0, 0.0, 0.0, 0.0, \
              0.0, 0.0, 0.0, 0.0, \
              0.0, 0.0, 0.0, 0.0, \
              0.0, 0.0, 0.0, 0.0, \
              0.0/)
        hybi=(/0.00000, 0.0500000, 0.100000, 0.150000, \
              0.200000, 0.250000, 0.300000, 0.350000, \
              0.400000, 0.450000, 0.500000, 0.550000, \
              0.600000, 0.650000, 0.700000, 0.750000, \
              0.800000, 0.850000, 0.900000, 0.950000, \
              1.00000/)
        end if

; -----------30 sigma levels.  Evenly spaced in level interfaces
       if(nlev .eq. 30 ) then
           hyai = (/ 1e-5, 0.0, \
             0.0, 0.0, 0.0, 0.0, \
             0.0, 0.0, 0.0, 0.0, \
             0.0, 0.0, 0.0, 0.0, \
             0.0, 0.0, 0.0, 0.0, 0.0, \
             0.0, 0.0, 0.0, 0.0, \
             0.0, 0.0, 0.0, 0.0, \
             0.0, 0.0, 0.0, 0.0/)
          hybi = (/ 0.00000, 0.0333333, 0.0666667, 0.100000, \
           0.133333, 0.166667, 0.200000, 0.233333, \
           0.266667, 0.300000, 0.333333, 0.366667, \
           0.400000, 0.433333, 0.466667, 0.500000, \
           0.533333, 0.566667, 0.600000, 0.633333, \
           0.666667, 0.700000, 0.733333, 0.766667, \
           0.800000, 0.833333, 0.866667, 0.900000, \
           0.933333, 0.966667, 1/)
       end if

; -----------40 sigma levels.  Evenly spaced in level interfaces
       if(nlev .eq. 40 ) then
;          hyai = (/ 1e-5, 0.0, \
;             0.0, 0.0, 0.0, 0.0, \
;             0.0, 0.0, 0.0, 0.0, \
;             0.0, 0.0, 0.0, 0.0, \
;             0.0, 0.0, 0.0, 0.0, \
;             0.0, 0.0, 0.0, 0.0, \
;             0.0, 0.0, 0.0, 0.0, \
;             0.0, 0.0, 0.0, 0.0, \
;             0.0, 0.0, 0.0, 0.0, \
;             0.0, 0.0, 0.0, 0.0, \ 
;             0.0, 0.0, 0.0/)
;          hyai = (/ 1e-5, 0.0, 0.0, 0.0, \
;           0.0, 0.0, 0.0, 0.0, \
;           0.0, 0.0, 0.0, 0.0, \
;           0.0, 0.0, 0.0, 0.0, \
;           0.0, 0.0, 0.0, 0.0, \
;           0.0, 0.0, 0.0, 0.0, \
;           0.0, 0.0, 0.0, 0.0, \
;           0.0, 0.0, 0.0/)
;          hybi = (/ 0.00000, 0.0333333, 0.0666667, 0.100000, \
;           0.133333, 0.166667, 0.200000, 0.233333, \
;           0.266667, 0.300000, 0.333333, 0.366667, \
;           0.400000, 0.433333, 0.466667, 0.500000, \
;           0.533333, 0.566667, 0.600000, 0.633333, \
;           0.666667, 0.700000, 0.733333, 0.766667, \
;           0.800000, 0.833333, 0.866667, 0.900000, \
;           0.933333, 0.966667, 1/)

           hyai = (/  1e-5, 0.0, 0.0, 0.0,  \
                   0.0, 0.0, 0.0, 0.0, \
                   0.0, 0.0, 0.0, 0.0, \
                   0.0, 0.0, 0.0, 0.0, \
                   0.0, 0.0, 0.0, 0.0, \
                   0.0, 0.0, 0.0, 0.0, \
                   0.0, 0.0, 0.0, 0.0, \
                   0.0, 0.0, 0.0, 0.0, \
                   0.0, 0.0, 0.0, 0.0, \
                   0.0, 0.0, 0.0, 0.0, 0.0/)

           hybi = (/  0.0, 0.0250000, 0.0500000, 0.0750000,  \    
                   0.100000, 0.125000, 0.150000, 0.175000, \
                   0.200000, 0.225000, 0.250000, 0.275000, \ 
                   0.300000, 0.325000, 0.350000, 0.375000, \
                   0.400000, 0.425000, 0.450000, 0.475000, \
                   0.500000, 0.525000, 0.550000, 0.575000, \
                   0.600000, 0.625000, 0.650000, 0.675000, \
                   0.700000, 0.725000, 0.750000, 0.775000, \
                   0.800000, 0.825000, 0.850000, 0.875000, \
                   0.900000, 0.925000, 0.950000, 0.975000, 1.0/)
       end if

; -----------60 sigma levels.  Evenly spaced in level interfaces
       if (nlev .eq. 60) then
        hyai = (/1e-5, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, \
         0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, \
         0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, \
         0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, \
         0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, \
         0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,\
         0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00 /)

        hybi = (/0.00000, 0.0166667, 0.0333334, 0.0500001, 0.0666668,  \
         0.0833335, 0.100000, 0.116667, 0.133334, 0.150000, 0.166667, \
         0.183334, 0.200000, 0.216667, 0.233334, 0.250000, 0.266667, \
         0.283334, 0.300001, 0.316667, 0.333334, 0.350001, 0.366667, \
         0.383334, 0.400001, 0.416667, 0.433334, 0.450001, 0.466668, \
         0.483334, 0.500001, 0.516668, 0.533334, 0.550001, 0.566668, \
         0.583334, 0.600001, 0.616668, 0.633335, 0.650001, 0.666668, \
         0.683335, 0.700001, 0.716668, 0.733335, 0.750001, 0.766668, \
         0.783335, 0.800002, 0.816668, 0.833335, 0.850002, 0.866668, \
         0.883335, 0.900002, 0.916668, 0.933335, 0.950002, 0.966669, \
         0.983335, 1.00000 /)
       end if

; -----------80 sigma levels.  Evenly spaced in level interfaces
       if (nlev .eq. 80) then 
        hyai = (/1e-5, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, \
      0.00, 0.00, 0.00, \
      0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, \
      0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, \
      0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, \
      0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, \ 
      0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, \
      0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, \
      0.00, 0.00, 0.00, 0.00/)

      hybi =  (/0.00000, 0.0125000, 0.0250000, 0.0375000, 0.0500000, 0.0625000, \
       0.0750000, 0.0875000, 0.100000, 0.112500, 0.125000, \
       0.137500, 0.150000, 0.162500, 0.175000, 0.187500, 0.200000, 0.212500, \
       0.225000, 0.237500, 0.250000, 0.262500, 0.275000, 0.287500, 0.300000, \
       0.312500, 0.325000, 0.337500, 0.350000, 0.362500, 0.375000, 0.387500, \
       0.400000, 0.412500, 0.425000, 0.437500, 0.450000, 0.462500, 0.475000, \
       0.487500, 0.500000, 0.512500, 0.525000, 0.537500, 0.550000, 0.562500, \
       0.575000, 0.587500, 0.600000, 0.612500, 0.625000, 0.637500, 0.650000, \
       0.662500, 0.675000, 0.687500, 0.700000, 0.712500, 0.725000, 0.737500, \
       0.750000, 0.762500, 0.775000, 0.787500, 0.800000, 0.812500, 0.825000, \  
       0.837500, 0.850000, 0.862500, 0.875000, 0.887500, 0.900000, 0.912500, \  
       0.925000, 0.937500, 0.950000, 0.962500, 0.975000, 0.987500, 1.00000/)

       end if


;--------------------------------------------------------------------------
; derived variables and values that have to be set in CAM files
; everything below is derived from previous values
;--------------------------------------------------------------------------

       nilev = nlev + 1

       hyai!0="ilev"
       hyai@long_name = "hybrid A coefficient at layer interfaces"

       hybi!0="ilev"
       hybi@long_name = "hybrid B coefficient at layer interfaces"

       hyam=new(nlev,"double")
       do plev = 0, nlev-1
          hyam(plev) = (hyai(plev)+hyai(plev+1))/2.
       end do
       hyam!0="lev"
       hyam@long_name = "hybrid A coefficient at layer midpoints"



; ------------------------------------------------------------------------
;    define mid-levels as the half way point between interfaces
; ------------------------------------------------------------------------
       hybm=new(nlev,"double")
       do plev = 0, nlev-1
          hybm(plev) = (hybi(plev)+hybi(plev+1))/2.
       end do


       hybm!0="lev"
       hybm@long_name = "hybrid B coefficient at layer midpoints"

       lev = (hyam+hybm)*1000.
       lev!0 = "lev"
       lev@long_name = "hybrid level at midpoints (1000*(A+B))"
       lev@units = "level"
       lev@positive = "down"
       lev@standard_name = "atmosphere_hybrid_sigma_pressure_coordinate"
       lev@formula_terms = "a: hyam b: hybm p0: P0 ps: PS"

       ilev = (hyai+hybi)*1000.
       ilev!0="ilev"
       ilev@long_name = "hybrid level at interfaces (1000*(A+B))"
       ilev@units = "level"
       ilev@positive = "down"
       ilev@standard_name = "atmosphere_hybrid_sigma_pressure_coordinate"
       ilev@formula_terms = "a: hyai b: hybi p0: P0 ps: PS"


